{% extends "base.html" %}
{% load i18n %}
{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
  <h2 style="margin: 0;">{% trans "SKUs ‚Äî Latest Prices" %}</h2>
  <div style="display: flex; gap: 1rem;">

    <form method="post" action="/admin/" target="_blank" style="display: inline; margin: 0;">
      {% csrf_token %}
      <button type="submit" class="btn btn-primary btn-sm" style="min-width:160px; text-align:center;">
        <span style="margin-right: 0.5rem;">‚öôÔ∏è</span>
        {% trans "Configure" %}
      </button>
    </form>

    <form method="post" action="{% url 'scrape_now' %}" style="display: inline; margin: 0;">
      {% csrf_token %}
      <button type="submit" class="btn btn-primary btn-sm" style="min-width:160px; text-align:center;">
        <span style="margin-right: 0.5rem;">üîÑ</span>
        {% trans "Scrape Now" %}
      </button>
    </form>
  </div>
</div>

<div style="max-height:400px; overflow-y:auto; display:block; scrollbar-width:none; -ms-overflow-style:none;">
  <table style="width:100%; border-collapse:collapse;">
    <thead style="position:sticky; top:0; background:#f97316; z-index:2; color:#fff;">
      <tr>
        <th style="padding:8px 12px; border:1px solid #ddd;">{% trans "SKU" %}</th>
        <th style="padding:8px 12px; border:1px solid #ddd;">{% trans "Name" %}</th>
        <th style="padding:8px 12px; border:1px solid #ddd;">{% trans "Latest Price" %}</th>
        <th style="padding:8px 12px; border:1px solid #ddd;">{% trans "Promo" %}</th>
        <th style="padding:8px 12px; border:1px solid #ddd;">{% trans "Currency" %}</th>
        <th style="padding:8px 12px; border:1px solid #ddd;"></th>
      </tr>
    </thead>
    <tbody style="background-color:#ffffff !important; color:#000000 !important;">
      {% for item in skus_with_prices %}
      <tr>
        <td
          style="padding:8px 12px; border:1px solid #ddd; background-color:#ffffff !important; color:#000000 !important;">
          {{ item.sku.code }}
        </td>
        <td
          style="padding:8px 12px; border:1px solid #ddd; background-color:#ffffff !important; color:#000000 !important;">
          {{ item.sku.name }}
        </td>
        <td
          style="padding:8px 12px; border:1px solid #ddd; background-color:#ffffff !important; color:#000000 !important;">
          {% if item.latest_price and item.latest_price.price %}
          {{ item.latest_price.price }}
          {% else %}
          <span style="color:#999;">{% trans "No data" %}</span>
          {% endif %}
        </td>
        <td
          style="padding:8px 12px; border:1px solid #ddd; background-color:#ffffff !important; color:#000000 !important;">
          {% if item.latest_price and item.latest_price.promo_price %}
          {{ item.latest_price.promo_price }} ({{ item.latest_price.promo_text }})
          {% else %}
          <span style="color:#999;">{% trans "No data" %}</span>
          {% endif %}
        </td>
        <td
          style="padding:8px 12px; border:1px solid #ddd; background-color:#ffffff !important; color:#000000 !important;">
          {% if item.latest_price %}{{ item.latest_price.raw_currency }}{% endif %}
        </td>
        <td
          style="padding:8px 12px; border:1px solid #ddd; background-color:#ffffff !important; color:#000000 !important;">
          <div class="table-actions">
            <a href="{% url 'sku_detail' item.sku.id %}"
              style="background-color:#999999 !important; white-space: nowrap; color:#ffffff !important; padding:4px 8px; text-decoration:none; border-radius:4px; font-size:0.875rem;">
              <span style="margin-right: 0.25rem;">üìä</span>
              {% trans "View Details" %}
            </a>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- esconder scrollbar no Chrome/Webkit -->
<style>
  div[style*="overflow-y:auto"]::-webkit-scrollbar {
    display: none;
  }
</style>


{% endblock %}